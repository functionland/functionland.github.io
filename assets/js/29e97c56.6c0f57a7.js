"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2212],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return f}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),l=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=l(e.components);return a.createElement(d.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},i=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,d=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),i=l(n),f=r,h=i["".concat(d,".").concat(f)]||i[f]||u[f]||o;return n?a.createElement(h,c(c({ref:t},p),{},{components:n})):a.createElement(h,c({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,c=new Array(o);c[0]=i;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:r,c[1]=s;for(var l=2;l<o;l++)c[l]=n[l];return a.createElement.apply(null,c)}return a.createElement.apply(null,n)}i.displayName="MDXCreateElement"},6005:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return l},toc:function(){return p},default:function(){return i}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),c=["components"],s={},d=void 0,l={unversionedId:"blockchain/Services/RunValidators",id:"blockchain/Services/RunValidators",title:"RunValidators",description:"A minimum of two validator nodes is required for the network to run.",source:"@site/docs/blockchain/Services/RunValidators.md",sourceDirName:"blockchain/Services",slug:"/blockchain/Services/RunValidators",permalink:"/blockchain/Services/RunValidators",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"BuildNode",permalink:"/blockchain/Services/BuildNode"},next:{title:"Node API",permalink:"/blockchain/Services/NodeAPI"}},p=[],u={toc:p};function i(e){var t=e.components,s=(0,r.Z)(e,c);return(0,o.kt)("wrapper",(0,a.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"A minimum of two validator nodes is required for the network to run."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Requires a ",(0,o.kt)("a",{parentName:"li",href:"BuildNode"},"Build")," .")),(0,o.kt)("hr",null),(0,o.kt)("p",null,"RUN TESNET VALIDATORS"),(0,o.kt)("p",null,"1) CREATION OF THE KEYS OF EACH VALIDATOR ACCOUNT (You need to do this steap twice at least):"),(0,o.kt)("p",null,"Note: For each validator node, we use the same password for Aura and Grandpa account, but the two validator nodes each have differnet passwords\t"),(0,o.kt)("p",null,"a) Generate the Aura Account"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"./target/release/sugarfunge-node key generate --scheme Sr25519 --password-interactive\n")),(0,o.kt)("p",null,"sample output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Secret phrase:     toe dust enhance uncover version polar ugly person sunset wrist swamp lawsuit\nNetwork ID:        substrate\nSecret seed:       0xf8a168f8d987dde4d48e055068f480ba64950173c9f58826effc3b7d9c699fb7\nPublic key (hex):  0x9cea935ffd8f8e72de04a1022e94fb80fc1e4c56e724e83cc995017f8735d40b\nAccount ID:        0x9cea935ffd8f8e72de04a1022e94fb80fc1e4c56e724e83cc995017f8735d40b\nPublic key (SS58): 5FcT1aGqnzvkq3gtp65CKz2qRBUTSUxUrmWkqAF8o9MCLHV1\nSS58 Address:      5FcT1aGqnzvkq3gtp65CKz2qRBUTSUxUrmWkqAF8o9MCLHV1\n")),(0,o.kt)("p",null,"b) Generate the Grandpa Account using the secret phrase of the Aura Account"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'./target/release/sugarfunge-node key inspect --password-interactive --scheme Ed25519 "toe dust enhance uncover version polar ugly person sunset wrist swamp lawsuit"\n')),(0,o.kt)("p",null,"sample output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Secret phrase:     toe dust enhance uncover version polar ugly person sunset wrist swamp lawsuit\nNetwork ID:        substrate\nSecret seed:       0xf8a168f8d987dde4d48e055068f480ba64950173c9f58826effc3b7d9c699fb7\nPublic key (hex):  0x629b9993ff8409b7a554e73272fd34fc8710a7ab7cc3a139850a283d1a451669\nAccount ID:        0x629b9993ff8409b7a554e73272fd34fc8710a7ab7cc3a139850a283d1a451669\nPublic key (SS58): 5EHzmmawH9HJPF6cEWeTcBLv8wHW43XUaVgypX462q8T1fbT\nSS58 Address:      5EHzmmawH9HJPF6cEWeTcBLv8wHW43XUaVgypX462q8T1fbT\n")),(0,o.kt)("p",null,"2) GENERATE THE NODE-KEY AND PEER-ID FOR EACH VALIDATOR ACCOUNT"),(0,o.kt)("p",null,"a) Generate a random node key and peer-id (run twice, once for each validator node)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"./target/release/sugarfunge-node key generate-node-key\n")),(0,o.kt)("p",null,"sample output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Peer-id: 12D3KooWC9nU1QzG8m3dZKSNqssmasdupLPhgu9adYe1h4ToBW7r\nkey: 4ac42a38b622dd9943c49ca9300000236406d35a43f0ce82eef556c1d81a4157\n")),(0,o.kt)("p",null,"b) Save the key as a file"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'echo -n "4ac42a38b622dd9943c49ca9300000236406d35a43f0ce82eef556c1d81a4157" > user-one-key\n')),(0,o.kt)("p",null,"And the same for user-two-key"),(0,o.kt)("p",null,"c) Verify that the peer-id is correct using the node-key stored "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"./target/release/sugarfunge-node key inspect-node-key --file user-one-key\n")),(0,o.kt)("p",null,"output should be the peer id"),(0,o.kt)("p",null,"3) CREATION OF CHAINSPECS AND CHAINSPECSRAW"),(0,o.kt)("p",null,"a) Before generating the CustomSpec.json, in the file node/src/chain_spec add the Peer-id of each of the validators in the node_authorization of the Genesis Config"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo nano ./node/src/chain_spec.rs\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Replacing Peer-id in the file",src:n(5921).Z,width:"722",height:"582"})),(0,o.kt)("p",null,"b) Generate the CustomSpec.json"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"./target/release/sugarfunge-node build-spec --disable-default-bootnode --chain local > customSpec.json\n")),(0,o.kt)("p",null,"output: A file named customSpec.json is created in the same folder"),(0,o.kt)("p",null,"c) Make the necessary changes if desired: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo nano ./customSpec.json\n")),(0,o.kt)("p",null,"Change the default account of Alice and Bob for Custom Accounts (At the end of hte file under session>keys find Aura and grandpa for both accounts and change all occurances of those)"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Changing default accounts",src:n(7186).Z,width:"405",height:"615"})),(0,o.kt)("p",null,"d) Once the changes to the CustomSpec.json have been made, generate the CustomSpecRaw.json"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"./target/release/sugarfunge-node build-spec --chain=customSpec.json --raw --disable-default-bootnode > customSpecRaw.json\n")),(0,o.kt)("p",null,"4) ADD THE KEYS TO THE KEYSTORE FOR EACH VALIDATOR: This is made so the Accounts can import and finished blocks if not added the accounts won't produce them"),(0,o.kt)("p",null,"a) Add the Aura Key (replace the key phrase with generated one in step 1):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'./target/release/sugarfunge-node key insert --base-path=.tmp/node01 --chain customSpecRaw.json --scheme Sr25519 --suri "toe dust enhance uncover version polar ugly person sunset wrist swamp lawsuit" --password-interactive --key-type aura\n')),(0,o.kt)("p",null,"b) Add the Grandpa Key (replace the key phrase with generated one in step 1):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'./target/release/sugarfunge-node key insert --base-path=.tmp/node01 --chain customSpecRaw.json --scheme Ed25519 --suri "toe dust enhance uncover version polar ugly person sunset wrist swamp lawsuit" --password-interactive --key-type gran\n')),(0,o.kt)("p",null,"Note: For other validators the following fields should be change accordingly:\n--base-path= .temp/node02\n--suri \u201c the corresponding secret phrase\u201d"),(0,o.kt)("p",null,"5) COMMANDS TO START THE NODES"),(0,o.kt)("p",null,"a) For the main validator node execute (replace the node-key with correct key of peer id):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cargo run --release -- --chain ./customSpecRaw.json --enable-offchain-indexing true --base-path=.tmp/node01 --port=30334 --ws-port 9944 --ws-external --rpc-cors=all --rpc-methods=Unsafe --rpc-external --validator --name MyNode01 --password-interactive --node-key=4ac42a38b622dd9943c49ca9300000236406d35a43f0ce82eef556c1d81a4157\n")),(0,o.kt)("p",null,"b) For the rest of validator nodes execute (replacing node-key with second peer id key and peerID after /p2p/ with the main node peer id) :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cargo run --release -- --chain ./customSpecRaw.json --enable-offchain-indexing true --base-path=.tmp/node02 --port=30335 --ws-port 9945 --ws-external --rpc-cors=all --rpc-methods=Unsafe --rpc-external --bootnodes /ip4/127.0.0.1/tcp/30334/p2p/12D3KooWC9nU1QzG8m3dZKSNqssmasdupLPhgu9adYe1h4ToBW7r --validator --name MyNode02 --password-interactive --node-key=5ed89682d5d0d2efd35f98a248b97cc1f6155e6af169719f3d54900d34a98a4a\n")),(0,o.kt)("p",null,"c) For the a node to listen to the validator nodes"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cargo run --release -- --chain ./customSpecRaw.json --enable-offchain-indexing true --base-path=.tmp/node03 --port=30336 --ws-port 9946 --ws-external --rpc-cors=all --rpc-methods=Unsafe --rpc-external --name MyNode03 --node-key=239afb9dae01b5c010c454f1e1df64ce83b3e13803540df079677860a745d168 --offchain-worker always\n")),(0,o.kt)("p",null,"Note: For each of the commands the following fields should be change accordingly:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"--base-path = .temp/node02 or .temp/node03\n--port = To a port not used in other commands\n--ws-port = To a port not used in other commands\n--bootnodes = Update the last segment value to the peer-id of the main validator obtained in step 2\n--name = to the given name\n--node-key with the node key values obtained in step 2 for each account\n")))}i.isMDXComponent=!0},5921:function(e,t,n){t.Z=n.p+"assets/images/validatorNode1-0a35cba37e32b7adf66a2ead3dd0185a.png"},7186:function(e,t,n){t.Z=n.p+"assets/images/validatorNode2-32750edd686d26b8bdf614c10b64f13d.png"}}]);