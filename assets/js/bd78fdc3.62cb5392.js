"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[839],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(a),m=r,k=c["".concat(s,".").concat(m)]||c[m]||d[m]||i;return a?n.createElement(k,l(l({ref:t},u),{},{components:a})):n.createElement(k,l({ref:t},u))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8692:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return u},default:function(){return c}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),l=["components"],o={},s="Personal Data Reserve",p={unversionedId:"RFCs/personal-data-reserve",id:"RFCs/personal-data-reserve",title:"Personal Data Reserve",description:"- Start Date: 2022-03-18",source:"@site/docs/RFCs/personal-data-reserve.md",sourceDirName:"RFCs",slug:"/RFCs/personal-data-reserve",permalink:"/RFCs/personal-data-reserve",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Document Syncing",permalink:"/RFCs/document-syncing"}},u=[{value:"Summary",id:"summary",children:[],level:2},{value:"Use Case",id:"use-case",children:[],level:2},{value:"Terminology",id:"terminology",children:[],level:2},{value:"Pre-conditions",id:"pre-conditions",children:[],level:2},{value:"Assumptions",id:"assumptions",children:[],level:2},{value:"Out of Scope",id:"out-of-scope",children:[],level:2},{value:"Limitations",id:"limitations",children:[],level:2},{value:"Configuration",id:"configuration",children:[{value:"Local Configuration",id:"local-configuration",children:[],level:3},{value:"Shared Configuration",id:"shared-configuration",children:[],level:3}],level:2},{value:"Conflict Resolution",id:"conflict-resolution",children:[],level:2},{value:"Events",id:"events",children:[{value:"Event Types",id:"event-types",children:[],level:3},{value:"Warnings",id:"warnings",children:[],level:3},{value:"Event Frequency",id:"event-frequency",children:[],level:3}],level:2},{value:"Implementation",id:"implementation",children:[{value:"Components",id:"components",children:[],level:3},{value:"Event Dispatcher",id:"event-dispatcher",children:[],level:3},{value:"File Integrity Monitoring",id:"file-integrity-monitoring",children:[],level:3},{value:"Network Architecture",id:"network-architecture",children:[],level:3}],level:2},{value:"Drawbacks",id:"drawbacks",children:[],level:2},{value:"Rationale and alternatives",id:"rationale-and-alternatives",children:[],level:2},{value:"Dependencies",id:"dependencies",children:[],level:2},{value:"Unresolved questions",id:"unresolved-questions",children:[],level:2},{value:"Future Possibilities",id:"future-possibilities",children:[{value:"History",id:"history",children:[],level:3},{value:"Regions",id:"regions",children:[],level:3}],level:2}],d={toc:u};function c(e){var t=e.components,a=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"personal-data-reserve"},"Personal Data Reserve"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Start Date: 2022-03-18"),(0,i.kt)("li",{parentName:"ul"},"RFC PR: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/functionland/docs/pull/61"},"functionland/docs/pull/61")),(0,i.kt)("li",{parentName:"ul"},"Functionland Issue: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/functionland/docs/issues/58"},"functionland/docs/issues/58")),(0,i.kt)("li",{parentName:"ul"},"Status: Draft"),(0,i.kt)("li",{parentName:"ul"},"Authors: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/gitaaron"},"Aaron Surty"),","),(0,i.kt)("li",{parentName:"ul"},"Reviewers: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/farhoud"},"Farhoud"),", ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/ehsan6sha"},"Ehsan"),", ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/orgs/functionland/people/masih"},"Masih"))),(0,i.kt)("h2",{id:"summary"},"Summary"),(0,i.kt)("p",null,"This RFC covers how a BOX customer's data can be replicated across a group of BOXes physically separated from each other to help prevent unwanted loss."),(0,i.kt)("h2",{id:"use-case"},"Use Case"),(0,i.kt)("p",null,"A person owns 3-5 BOXes (eg/ one in their home, one at their office and one at a friend's house)."),(0,i.kt)("p",null,"Their basement floods bricking the one located in their home."),(0,i.kt)("p",null,"They are still able to access all of the data that was uploaded to their bricked home BOX from one of their other BOXes or a brand new BOX provisioned with factory settings."),(0,i.kt)("p",null,"The following scenarios are handled:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"adding a new BOX to the reserve")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"removing a BOX from the reserve")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"data becomes corrupted on a BOX"))),(0,i.kt)("h2",{id:"terminology"},"Terminology"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Definition"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"reserve"),(0,i.kt)("td",{parentName:"tr",align:null},"a group of keepers collaboratively working together to back up a snapshot")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"snapshot"),(0,i.kt)("td",{parentName:"tr",align:null},"a collection of data that represents the entire file system being backed up at a given moment in time")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"chunk"),(0,i.kt)("td",{parentName:"tr",align:null},"a portion of a data set")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"keeper"),(0,i.kt)("td",{parentName:"tr",align:null},"a BOX process responsible for backing up a file system to the reserve")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"retriever"),(0,i.kt)("td",{parentName:"tr",align:null},"a BOX process given the task of rebuilding a usable file system from a snapshot")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"author"),(0,i.kt)("td",{parentName:"tr",align:null},"the BOX where the backed up data set was created")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"peer"),(0,i.kt)("td",{parentName:"tr",align:null},"a member of the reserve")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"replication factor"),(0,i.kt)("td",{parentName:"tr",align:null},"how many keepers a chunk of data is stored on; a greater replication factor means greater resilience")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"data set"),(0,i.kt)("td",{parentName:"tr",align:null},"a file, directory, or data from a database")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"warning time window"),(0,i.kt)("td",{parentName:"tr",align:null},"how much time should be given to send an alert before an imminent limitation is encountered and a system failure occurs")))),(0,i.kt)("h2",{id:"pre-conditions"},"Pre-conditions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"the owner has already authenticated themselves with each BOX")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"the fula-api is persisting data to a disk accessible by the keeper")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"each BOX is already provisioned with the necessary configuration info required to operate a reserve"))),(0,i.kt)("h2",{id:"assumptions"},"Assumptions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"each keeper in a reserve can be trusted to not operate maliciously by performing unwanted delete operations")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"the data being backed up is:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"multimedia files  such as photos and video"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://orbitdb.org/"},"orbit db")," metadata "),(0,i.kt)("li",{parentName:"ul"},"plain text files for shared configuration data")))),(0,i.kt)("h2",{id:"out-of-scope"},"Out of Scope"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"high-frequency updates to data sets which might be encountered with multi-tenancy or recording streaming video")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"syncing of data between BOXes so that it is usable on each BOX (eg/ CRUD operations on them in real time)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"conflicts arising from concurrent updates initiated by a user on several different BOXes")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"heuristics used to minimize bandwidth and improve availability"))),(0,i.kt)("h2",{id:"limitations"},"Limitations"),(0,i.kt)("p",null,"The following limitations may be encountered while operating a reserve:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"file size"),(0,i.kt)("li",{parentName:"ul"},"number of files in a directory"),(0,i.kt)("li",{parentName:"ul"},"snapshot size"),(0,i.kt)("li",{parentName:"ul"},"number of keepers in a reserve")),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"Configuration data for each peer can be split into local and shared."),(0,i.kt)("h3",{id:"local-configuration"},"Local Configuration"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"local BOX address")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"local public/private key"))),(0,i.kt)("h3",{id:"shared-configuration"},"Shared Configuration"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"remote BOX addresses of other peers in the reserve")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"shared secret")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"minimum acceptable replication factor")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"'normal' event dispatching frequency")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"warning time window"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"has a global default as well as an override for each limitation")))),(0,i.kt)("h2",{id:"conflict-resolution"},"Conflict Resolution"),(0,i.kt)("p",null,"Although it can be assumed the snapshot is already free from conflicts caused by concurrent updates initiated from a user, conflicts may still arise from disk corruption or other unforseen keeper errors."),(0,i.kt)("p",null,"The disputing keepers will take the appropriate steps to resolve the conflict.  If an appropriate resolution can not be achieved, an event is  raised."),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("p",null,"The following events are dispatched for an administrative UI."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"limitation imminent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"limitation encountered")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"keeper health"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"memory"),(0,i.kt)("li",{parentName:"ul"},"disk I/O"),(0,i.kt)("li",{parentName:"ul"},"CPU usage"),(0,i.kt)("li",{parentName:"ul"},"disk corruption"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"unresolved conflict")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"unacceptable replication factor")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"keeper added / removed")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"network disruption"))),(0,i.kt)("h3",{id:"event-types"},"Event Types"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"normal"),(0,i.kt)("li",{parentName:"ul"},"warning"),(0,i.kt)("li",{parentName:"ul"},"failure")),(0,i.kt)("h3",{id:"warnings"},"Warnings"),(0,i.kt)("p",null,"Events dispatched before a failure occurs based on a forecasting heuristic to determine how quickly a limit will be reached."),(0,i.kt)("h3",{id:"event-frequency"},"Event Frequency"),(0,i.kt)("p",null,"Normal events are dispatched periodically (based on a config param) for historical reporting and warnings|failures are dispatched immediately."),(0,i.kt)("h2",{id:"implementation"},"Implementation"),(0,i.kt)("h3",{id:"components"},"Components"),(0,i.kt)("p",null,"The components that are needed for this use case are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"data set keeper")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"data set retriever")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"event dispatcher")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"file integrity monitor"))),(0,i.kt)("h3",{id:"event-dispatcher"},"Event Dispatcher"),(0,i.kt)("p",null,"A mechanism for dispatching events and queueing them to prevent loss if a peer goes down."),(0,i.kt)("h3",{id:"file-integrity-monitoring"},"File Integrity Monitoring"),(0,i.kt)("p",null,"For detecting / handling disk corruption."),(0,i.kt)("p",null,"A full sweep of the file system is periodically done comparing the contents of chunks on disk with a source of truth."),(0,i.kt)("h3",{id:"network-architecture"},"Network Architecture"),(0,i.kt)("p",null,"A peer-peer architecture is used over master/slave so that if a single BOX goes down the rest of the reserve will still be able to operate normally."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"any shared config data is stored on each BOX")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"any shared state required for the retrieval of a data set is stored on each BOX")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"no central servers are used for networking"))),(0,i.kt)("h2",{id:"drawbacks"},"Drawbacks"),(0,i.kt)("p",null,"Putting the responsibility of data reliability on BOX owners means there is potential for a BOX owner to make a mistake and permanently lose their data."),(0,i.kt)("h2",{id:"rationale-and-alternatives"},"Rationale and alternatives"),(0,i.kt)("p",null,"An alternative could be to use paid services (cloud storage providers) with their own SLAs to take on the responsibility of data reliability."),(0,i.kt)("p",null,"If participating in a decentralized storage network (DSN), the BOX owner could also purchase a mining component to offset their cost."),(0,i.kt)("p",null,"There are currently a few drawbacks with this:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"becoming a storage miner requires a significant upfront investment to cover hardware and staking costs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"a private reserve will always be more efficient since keepers will not have to worry about the overhead of trusting each other"))),(0,i.kt)("p",null,"These options are not mutually exclusive.  Offering both options (free and paid) could provide the greatest freedom/flexibility for BOX owners."),(0,i.kt)("h2",{id:"dependencies"},"Dependencies"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"https://cluster.ipfs.io/"},"IPFS cluster"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"private connections")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"authentication")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"retriever")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"keeper"))),(0,i.kt)("p",null,"@TODO - provide links to relevant docs"),(0,i.kt)("h2",{id:"unresolved-questions"},"Unresolved questions"),(0,i.kt)("p",null,"What is an ideal replication factor?"),(0,i.kt)("p",null,"How can resilience be measured? Markov models?"),(0,i.kt)("p",null,"How can contents of an entire filesystem be efficiently compared with a source of truth?"),(0,i.kt)("p",null,"How can system resources and their limits be calculated?"),(0,i.kt)("p",null,"How can NAT hole punching work in a pnet without any relays?"),(0,i.kt)("p",null,"Should data compression be taken into account?"),(0,i.kt)("h2",{id:"future-possibilities"},"Future Possibilities"),(0,i.kt)("h3",{id:"history"},"History"),(0,i.kt)("p",null,"Storing a history snapshots so an owner can go back in time and recover a data set from a previous state.  This could help with data loss due to user errors."),(0,i.kt)("h3",{id:"regions"},"Regions"),(0,i.kt)("p",null,"A person or group of people may have a large number of BOXes and want to set up geographically grouped regions such that if there is a severe network outage, each region will still be able to recover the entire contents of a snapshot."))}c.isMDXComponent=!0}}]);